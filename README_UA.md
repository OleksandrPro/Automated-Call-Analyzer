# Automated-Call-Analyzer (Автоматичний аналізатор дзвінків)
Скрипт на Python для автоматизації транскрипції, аналізу та внесення даних із дзвінків служби підтримки до Google-таблиці. Інструмент обробляє аудіофайли, оцінює роботу менеджерів та категоризує теми дзвінків.

## Налаштування

**Важливі зауваження щодо середовища:**

* **Python:** Цей проєкт був розроблений та протестований з використанням **Python 3.12.3**.
* **Операційна система:** Проєкт розроблявся у середовищі **Linux**.

Хоча інші версії Python 3.x можуть працювати, **Python 3.12.3** наполегливо рекомендується. Запуск проєкту на інших операційних системах (наприклад, Windows або macOS) **не гарантує** повної сумісності, оскільки поведінка залежностей може відрізнятися.

1.  **Клонуйте репозиторій:**

    ```bash
    git clone git@github.com:OleksandrPro/Automated-Call-Analyzer.git
    ```

    ```bash
    cd Automated-Call-Analyzer/
    ```

2.  **Встановіть залежності:**

    **Рекомендується використовувати віртуальне середовище:**
    ```bash
    python -m venv venv
    ```

    **Активувати venv (Linux):**
    ```bash
    source venv/bin/activate
    ```

    **Встановити пакети:**
    ```bash
    pip install -r requirements.txt
    ```

## Кроки налаштування

Налаштування цього проєкту складається з трьох основних частин:
1.  **Отримання облікових даних Google AI (Gemini).**
2.  **Отримання облікових даних Google Drive та Sheets (OAuth 2.0).**
3.  **Налаштування файлу `.env`.**

## Частина 1: Отримайте ключ API Gemini

Вам потрібен ключ API для використання Gemini API.

1.  Перейдіть до [Google AI Studio](https://aistudio.google.com/).
2.  Увійдіть у свій акаунт Google.
3.  Натисніть **"Get API key"** (Отримати ключ API) та створіть новий ключ.
4.  Скопіюйте цей ключ. Ви вставите його у свій файл `.env` як `GEMINI_API_KEY`.

---

## Частина 2: Налаштування Google Drive та Sheets

Перш ніж ви зможете запустити додаток, вам потрібно налаштувати сервіси Google та отримати необхідні ID.

### 1. Отримайте облікові дані Google Drive та Sheets (OAuth 2.0)

Цей проєкт отримує доступ до Google Drive та Sheets від вашого імені (як "особистий" акаунт), що вимагає **OAuth 2.0**.

1.  Перейдіть до [Google Cloud Console](https://console.cloud.google.com/).
2.  Створіть новий проєкт (або виберіть наявний).
3.  **Увімкніть API:** На панелі інструментів вашого проєкту перейдіть до "APIs & Services" > "Library".
4.  Знайдіть та **увімкніть** наступні два API:
    * **Google Drive API**
    * **Google Sheets API**
5.  **Налаштуйте екран згоди OAuth:**
    * Перейдіть до "APIs & Services" > "OAuth consent screen".
    * Виберіть **"External"** (Зовнішній) та натисніть "Create".
    * Заповніть обов'язкові поля (назва додатка, email підтримки користувачів).
    * На сторінці "Scopes" (Області доступу) вам не потрібно нічого додавати.
    * На сторінці "Test users" (Тестові користувачі), **додайте власну адресу електронної пошти Google**. Це авторизує ваш акаунт для використання додатка до його "публікації".
6.  **Створіть облікові дані:**
    * Перейдіть до "APIs & Services" > "Credentials".
    * Натисніть "Create Credentials" > **"OAuth client ID"** (Ідентифікатор клієнта OAuth).
    * Для "Application type" (Тип додатка) виберіть **"Desktop app"** (Додаток для комп'ютера). (Це найпростіший варіант для локальних скриптів).
    * Натисніть "Create".
    * З'явиться вікно з вашим "Client ID" та "Client Secret". Натисніть **"Download JSON"** (Завантажити JSON).
7.  **Збережіть облікові дані:**
    * Перейменуйте завантажений файл на **`client_secret.json`**.
    * Розмістіть цей файл у каталозі `app_data/`.


### 2. Отримайте URL вашої Google-таблиці

1.  Створіть нову Google-таблицю або знайдіть ту, яку хочете використовувати.

2.  **Перевірка формату файлу (Важливо!):** Цей скрипт працює **лише з "рідними" Google-таблицями**, а не з файлами Microsoft Excel (`.xlsx`).

    * Якщо ваш файл наразі є файлом `.xlsx`, ви **повинні** його конвертувати.
    * Відкрийте файл `.xlsx` на вашому Google Drive.
    * Натисніть **File** -> **Save as Google Sheets** (Файл -> Зберегти як Google-таблицю).
    * Це створить *новий, окремий файл* (він матиме зелену іконку Google Sheets). **Ви повинні використовувати цей новий файл** для наступного кроку.

3.  Скопіюйте повне URL **"рідної" Google-таблиці** (конвертованої) з адресного рядка вашого браузера.
    * *Приклад:* `https://docs.google.com/spreadsheets/d/1abc-123_YOUR_ID_HERE/edit`

### 3. Отримайте ID ваших папок на Google Drive

Вам потрібно буде вказати принаймні один ID папки:

* **Папка з аудіофайлами (Обов'язково):** Звідки скрипт шукатиме аудіофайли.
* **Папка з транскрипціями (Необов'язково):** Куди скрипт зберігатиме `.json` транскрипції.

**Примітка:** Вказувати окрему `Папку з транскрипціями` **необов'язково**. Якщо ви залишите змінну `GOOGLE_DRIVE_TRANSCRIPTION_FOLDER_ID` порожньою у вашому `.env` файлі, скрипт автоматично збереже всі транскрипції в головну **Папку з аудіофайлами**.

Щоб отримати ID:

1.  Створіть папку на Google Drive (наприклад, "Дзвінки") або використовуйте наявну.
2.  Відкрийте папку. URL у вашому браузері матиме такий вигляд:
    `https://drive.google.com/drive/u/1/folders/`**`13MKq82OEhenoFlOnuHalenH9fxTsj1Nl`**
3.  Останній рядок випадкових символів — це **ID папки**.
4.  Скопіюйте цей ID. Повторіть процес, лише якщо ви хочете використовувати окрему папку для транскрипцій.

---

## Частина 3: Змінні середовища (.env)

Тепер створіть ваш локальний файл середовища.

1.  Створіть файл `.env` у корені проєкту.
2.  Відкрийте файл `.env` та заповніть змінні, як описано нижче.

    ```env
    # З Частини 1 (Google AI Studio)
    GEMINI_API_KEY="your_gemini_api_key_here"
    GEMINI_MODEL="gemini-2.5-flash" # я використовував цю модель
    
    # --- Google Drive & Sheets ---
    
    # Назва папки на вашому Google Drive (використовується як запасний варіант, якщо AUDIOFILES_FOLDER_ID відсутній)
    GOOGLE_DRIVE_AUDIOFILES_FOLDER_NAME="YourAudioFolderName"
    
    # ID папки, де знаходяться аудіофайли
    GOOGLE_DRIVE_AUDIOFILES_FOLDER_ID="your_folder_id_from_url"

    # (Необов'язково) ID папки для збереження транскрипцій.
    # Якщо залишити порожнім, транскрипції будуть збережені в AUDIOFILES_FOLDER.
    GOOGLE_DRIVE_TRANSCRIPTION_FOLDER_ID=""
    
    # Повне URL "рідної" Google-таблиці для логування
    TABLE_URL=""
    ```



## Запуск додатка

### Перша автентифікація (Обов'язково)

Під час першого запуску скрипту йому знадобиться ваш дозвіл на доступ до Drive/Sheets.

1.  Запустіть додаток:
    ```bash
    python3 src/main.py
    ```
    або

    ```bash
    python src/main.py
    ```
2.  **Відкриється вікно браузера**, або **URL буде надруковано** у вашій консолі.
3.  Відкрийте цей URL. Увійдіть, використовуючи **той самий особистий акаунт Google**, який ви додали як "Тестового користувача" у Частині 2.
4.  Google попросить вас надати дозвіл (наприклад, "Переглядати, редагувати, створювати та видаляти ваші файли Google Drive"). Натисніть **"Allow"** (Дозволити).
5.  Після надання дозволу, вас буде перенаправлено на сторінку підтвердження, і скрипт продовжить виконання.

Додаток автоматично створить новий файл (часто з назвою `token.json` або схожою) у каталозі `app_data/`. Цей файл зберігає вашу авторизацію і буде використовуватися для всіх майбутніх запусків.


### Подальші запуски

Після першого запуску ви можете запускати додаток як зазвичай, і він автоматично використовуватиме збережений `token.json` для автентифікації.


```bash
python3 src/main.py
```

або

```bash
python src/main.py
```